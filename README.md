# 🏗️ 城市建設遊戲

這是一個基於Web的城市建設與資源管理遊戲，類似《Anno 1800》的核心玩法。遊戲採用TypeScript開發，具備格子地圖、建築放置、資源生產鏈與人口管理等模擬策略功能。

## 🎮 遊戲特色

- **主選單系統**: 美觀的主選單界面，支援新遊戲、載入、隨機地圖
- **目標系統**: 銅級、銀級、金級三個難度等級，每級包含多個挑戰目標
- **時間管理**: 即時時間顯示，部分目標包含時間限制挑戰
- **格子式地圖系統**: 支援水陸區域、資源礦區等多種地形
- **智能地圖生成**: 使用種子確保可重現的隨機地圖，保證遊戲可完成性
- **建築系統**: 8種不同功能的建築，支援生產鏈管理
- **資源管理**: 木材、食物、石材、鐵礦、金幣、水源等多種資源
- **人口系統**: 人口成長與建築解鎖機制
- **即時遊戲循環**: 每秒更新的資源生產與消耗
- **儲存系統**: 支援localStorage存檔/讀檔
- **響應式UI**: 適配桌面與平板設備

## 🏆 目標系統

### 🥉 銅級目標
- **初始聚落**: 建立基本的生存設施
- **資源收集者**: 收集足夠的基礎資源
- **快速發展**: 在30分鐘內達到人口20

### 🥈 銀級目標
- **工業革命**: 解鎖並建設工業建築
- **貿易大亨**: 建立商業網絡
- **效率專家**: 在45分鐘內完成所有銅級目標

### 🥇 金級目標
- **繁榮都市**: 建設一個大型城市
- **資源帝國**: 累積大量資源
- **速度之王**: 在60分鐘內完成所有目標

## 🏗️ 建築類型

| 建築 | 圖標 | 功能 | 大小 | 解鎖條件 |
|------|------|------|------|----------|
| 民房 | 🏠 | 提供人口容量 | 1x1 | 初始 |
| 農場 | 🌾 | 生產食物 | 2x2 | 初始 |
| 伐木場 | 🪓 | 生產木材 | 1x1 | 初始 |
| 採石場 | ⛏️ | 生產石材 | 2x2 | 初始 |
| 水井 | 🚰 | 提供水源 | 1x1 | 初始 |
| 礦場 | ⚒️ | 生產鐵礦 | 2x2 | 人口20+ |
| 市場 | 🏪 | 生產金幣 | 2x2 | 人口50+ |
| 倉庫 | 🏬 | 增加儲存容量 | 2x2 | 人口30+ |

## 🎯 遊戲流程

1. **選擇難度**: 在主選單選擇銅級、銀級或金級目標
2. **選擇地圖**: 使用預設地圖或生成隨機地圖
3. **初期發展**: 建造民房、農場、伐木場等基礎建築
4. **資源管理**: 平衡資源生產與消耗，確保人口穩定成長
5. **目標追蹤**: 查看右側目標面板，追蹤完成進度
6. **城市擴張**: 解鎖更高級建築，建立完整的生產鏈
7. **挑戰完成**: 在時間限制內完成所有目標

## 🕹️ 操作說明

### 主選單操作
- **🎮 開始新遊戲**: 選擇難度後開始新的遊戲
- **📁 載入遊戲**: 載入之前保存的遊戲進度
- **🎲 隨機地圖**: 使用隨機種子生成新地圖
- **🥉🥈🥇 難度選擇**: 選擇目標難度等級

### 遊戲內操作
- **地圖操作**:
  - 滑鼠滾輪：縮放地圖
  - 滑鼠拖拽：移動地圖視角
  
- **建築操作**:
  - 點擊右側建築按鈕選擇要建造的建築
  - 再次點擊相同按鈕可取消選擇
  - 點擊地圖上的空地放置建築
  - 建築需要消耗相應資源且符合地形要求
  
- **遊戲控制**:
  - 💾 儲存：將遊戲進度保存到本地
  - 📁 載入：讀取之前保存的遊戲進度
  - ⏸️ 暫停：暫停/恢復遊戲時間流逝
  - 🏠 選單：返回主選單

### UI面板說明
- **左上角 - 資源面板**: 顯示當前資源數量和容量
- **正上方 - 時間面板**: 顯示遊戲時間、目標等級和地圖種子
- **右上角 - 建築面板**: 建築選擇和建造
- **右側 - 目標面板**: 當前目標和完成進度
- **左下角 - 狀態面板**: 人口信息和系統消息
- **右下角 - 控制面板**: 遊戲控制按鈕

## 🛠️ 技術架構

本遊戲採用現代前端技術棧，遵循物件導向設計原則：

### 核心技術
- **TypeScript**: 提供型別安全和良好的開發體驗
- **Canvas 2D**: 高效能地圖渲染
- **Vite**: 快速的建構工具
- **localStorage**: 本地存檔系統

### 系統架構
```
src/
├── types/           # 型別定義
├── core/            # 遊戲核心邏輯
│   ├── Game.ts         # 主遊戲類別
│   ├── ResourceManager.ts    # 資源管理
│   ├── MapManager.ts         # 地圖管理
│   └── BuildingManager.ts    # 建築管理
├── data/            # 遊戲數據配置
│   ├── buildings.ts    # 建築定義
│   └── goals.ts        # 目標配置
├── renderer/        # 渲染系統
├── ui/              # UI管理
│   ├── UIManager.ts    # 遊戲UI
│   └── MenuManager.ts  # 主選單
└── main.ts          # 程式入口
```

### 設計模式
- **狀態機模式**: 遊戲狀態管理（選單、遊戲中、已完成）
- **管理者模式**: 各系統獨立管理各自職責
- **組合模式**: 遊戲狀態由多個管理器組合而成
- **策略模式**: 建築定義與邏輯分離
- **觀察者模式**: UI與遊戲狀態的更新機制

## 🌟 新功能亮點

### 🎯 智能目標系統
- 三個難度等級，每級包含3個不同類型的目標
- 即時進度追蹤，清晰顯示完成狀態
- 目標完成自動獎勵系統
- 時間限制挑戰增加遊戲張力

### 🗺️ 智能地圖生成
- 使用種子系統確保地圖可重現
- 保證充足的建設用地和資源分佈
- 合理的地形配置確保遊戲可完成性
- 支援隨機地圖探索

### 🎮 完整的選單系統
- 美觀的漸層背景主選單
- 直觀的難度選擇界面
- 智能的存檔狀態檢測
- 流暢的狀態切換動畫

### ⏱️ 時間管理系統
- 即時遊戲時間顯示
- 目標時間限制倒數計時
- 暫停/繼續功能
- 時間相關的挑戰目標

## 🚀 開發與運行

### 環境要求
- Node.js 16+
- 現代瀏覽器 (Chrome, Firefox, Safari)

### 安裝依賴
```bash
npm install
```

### 開發模式
```bash
npm run dev
```
遊戲將在 http://localhost:3000 或下一個可用端口運行

### 建構生產版本
```bash
npm run build
```

### 預覽建構結果
```bash
npm run preview
```

## 🎨 遊戲截圖說明

1. **主選單**: 漸層背景，目標難度選擇，載入遊戲狀態檢測
2. **遊戲界面**: 完整的UI面板佈局，即時信息顯示
3. **目標追蹤**: 詳細的進度顯示和完成狀態
4. **地圖渲染**: 清晰的地形顯示和建築放置
5. **時間管理**: 遊戲時間和目標倒數計時

## 📈 未來擴展計劃

- [ ] 更多建築類型和科技樹
- [ ] 貿易系統和市場機制
- [ ] 多島嶼地圖系統
- [ ] 災害和挑戰事件
- [ ] 多人遊戲支援
- [ ] 圖形資源替換圖標
- [ ] 音效和背景音樂
- [ ] 成就系統和排行榜
- [ ] 自定義目標編輯器
- [ ] 地圖分享功能

## 🐛 問題排除

### 常見問題
1. **遊戲無法啟動**: 檢查瀏覽器控制台錯誤信息
2. **存檔無法載入**: 清除瀏覽器localStorage重新開始
3. **建築無法放置**: 檢查地形要求和資源是否足夠
4. **目標無法完成**: 查看目標面板的詳細進度要求

### 調試功能
- 遊戲實例附加到 `window.townGame`，可在控制台調試
- 詳細的控制台日誌輸出
- 完整的錯誤處理和提示

## 📝 授權

本專案採用 MIT 授權協議。

---

🎮 **開始你的城市建設之旅吧！選擇你的挑戰，建設繁榮的城市！** 🏰 